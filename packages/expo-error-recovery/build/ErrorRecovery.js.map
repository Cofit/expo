{"version":3,"file":"ErrorRecovery.js","sourceRoot":"","sources":["../src/ErrorRecovery.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,mBAAmB,EAAE,MAAM,kBAAkB,CAAC;AACvD,OAAO,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAC;AAC9B,OAAO,iBAAiB,MAAM,qBAAqB,CAAC;AAEpD,MAAM,mBAAmB,GAAG,IAAI,CAAC,GAAG,EAAE;IACpC,oCAAoC;IACpC,iIAAiI;IACjI,MAAM,aAAa,GAAG,UAAU,CAAC,gBAAgB,EAAE,CAAC;IACpD,UAAU,CAAC,gBAAgB,CAAC,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE;QACnD,MAAM,iBAAiB,CAAC,iBAAiB,EAAE,CAAC;QAC5C,aAAa,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAChC,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,MAAM,GAAG,iBAAiB,CAAC,MAAM,CAAC;AAE/C,MAAM,UAAU,gBAAgB,CAAC,KAA6B;IAC5D,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,EAAE;QACvC,MAAM,IAAI,mBAAmB,CAAC,eAAe,EAAE,kBAAkB,CAAC,CAAC;KACpE;IACD,iBAAiB,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;IAC1C,mBAAmB,EAAE,CAAC;AACxB,CAAC","sourcesContent":["import { UnavailabilityError } from '@unimodules/core';\nimport { once } from 'lodash';\nimport ExpoErrorRecovery from './ExpoErrorRecovery';\n\nconst globalHadlerSwapper = once(() => {\n  // ErrorUtlis came from react-native\n  // https://github.com/facebook/react-native/blob/1151c096dab17e5d9a6ac05b61aacecd4305f3db/Libraries/vendor/core/ErrorUtils.js#L25\n  const globalHandler = ErrorUtils.getGlobalHandler();\n  ErrorUtils.setGlobalHandler(async (error, isFatal) => {\n    await ExpoErrorRecovery.saveRecoveryProps();\n    globalHandler(error, isFatal);\n  });\n});\n\nexport const errors = ExpoErrorRecovery.errors;\n\nexport function setRecoveryProps(props: { [key: string]: any }): void {\n  if (!ExpoErrorRecovery.setRecoveryProps) {\n    throw new UnavailabilityError('ErrorRecovery', 'setRecoveryProps');\n  }\n  ExpoErrorRecovery.setRecoveryProps(props);\n  globalHadlerSwapper();\n}\n"]}